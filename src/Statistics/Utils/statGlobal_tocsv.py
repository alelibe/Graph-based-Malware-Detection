import json
import pandas as pd
import numpy as np


with open("C:/Users/Alessia/Desktop/stat_global.json") as jsonFile:
    stat = json.load(jsonFile)


column = ["onClick-Total","onClick-Handled","startActivity-Total","startActivity-Handled",
          "startService-Total","startService-Handled","switch-Total"]

df = np.zeros((len(stat.keys()),len(column)))

for i,dateValue in enumerate(stat.values()):
    j = 0
    for method,method_value in zip(dateValue.keys(),dateValue.values()):
        df[i,j] = method_value["total"]
        j += 1
        if not method == "switch":
            df[i,j] = method_value["handled"]
            j += 1


df = pd.DataFrame(df,index=stat.keys(),columns=column)
df.to_csv("Statistics/statCompletedAPK.csv", index_label="Date")