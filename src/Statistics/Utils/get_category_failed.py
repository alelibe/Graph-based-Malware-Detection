import json

malgraph_drebin_meta = "/home/laser//DREBIN/malgraph-drebin-meta.json"
malgraph_drebin_y = "/home/laser/DREBIN/malgraph-drebin-y.json"

def openFileMalgraphDREBIN():
    with open(malgraph_drebin_meta,"r") as fmeta:
        drebin_meta = json.load(fmeta)
        
    with open(malgraph_drebin_y,"r") as fy:
        drebin_y = json.load(fy)
        
    return drebin_meta,drebin_y


def updateFileMissAPK(apkFailed_y):
    with open("./failedAPK-y.json","w") as jsonFile:
        json.dump(apkFailed_y,jsonFile)



drebin_meta,drebin_y = openFileMalgraphDREBIN()

#contains the label (0 or 1) for failed apks
apkFailed_y = []

apkFailed = "/home/laser/apkFailed.json"
with open(apkFailed) as list_apk:
    list_apkFailed = json.load(list_apk)

for sha in list_apkFailed:
    print(sha)
    apk_index = next((index for (index, d) in enumerate(drebin_meta) if d["sha256"] == str(sha)), None)
    apkFailed_y.append(drebin_y[apk_index])



updateFileMissAPK(apkFailed_y)
