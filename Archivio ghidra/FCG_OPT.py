#TODO write a description for this script
#@author 
#@category _NEW_
#@keybinding 
#@menupath 
#@toolbar 

def parseNameSpace(namespace, concatenate = False, sep = "_"):
	if not(concatenate):
		className = namespace.split("::")[-1]
		end_index = className.find(" ")
		return className[:end_index]
	else:
		splitName = namespace.split("::")
		return splitName[-1] + sep + splitName[-2]


listing = currentProgram.getListing()
fm = currentProgram.getFunctionManager()
symTB = currentProgram.getSymbolTable()
symbols = symTB.getSymbols("onReceive")
while symbols.hasNext():
    sym = symbols.next()
    namespace = sym.getParentNamespace()
    className = parseNameSpace(str(namespace))
    print(className)
    print(namespace)
    addr = sym.getAddress()
    print(addr)
    f = listing.getFunctionAt(addr)
    if f != None:
        print(f.getBody())
