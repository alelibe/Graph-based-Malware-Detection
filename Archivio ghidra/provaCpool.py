#TODO write a description for this script
#@author 
#@category References
#@keybinding 
#@menupath 
#@toolbar 

import Utils

listing = currentProgram.getListing()
fm = currentProgram.getFunctionManager()
funcs = fm.getFunctions(True)
for f in funcs:
	if "onCreate" in str(f.getName()):
		body = f.getBody()


ins_iter = listing.getInstructions(body, True)
while ins_iter.hasNext():
	ins = ins_iter.next()
	if "invoke_virtual" in str(ins):
		print str(ins), ins.getAddress()
		register1 = (ins.getRegister(2).getName())

		dec = DetectIns(ins,ins,ins,ins)
		

	if "new_instance" in str(ins):
		print str(ins)
		addr = ins.getAddress()
		register2 = ins.getRegister(0).getName()
		equateTable = currentProgram.getEquateTable()
		pathClass = str(equateTable.getEquates(addr,1)[0]).split("/")[-1]
		end_index = pathClass.find(";")
		classMethod = pathClass[:end_index]
		print classMethod

		
		
	
